class @Application
  @client = new Pusher(gon.pusher_key)

  constructor: () ->
    this.mixin_controller()
    this.render() if this.correct_view()

  correct_view: ->
    gon.current_controller==this.controller() and gon.current_action==this.view()

  capitalize  = (string) ->
    string.charAt(0).toUpperCase()+string.slice(1)

  mixin_controller: ->
    #This will import all the methods in the controllers to the appropriate view
    #Ex: methods in RoomsController.index will be imported into RoomsIndex
    #If this.controller() = "rooms", this.view()="index", this becomes:
    # for name,method of window["RoomsController"]["index"]
    #   window["RoomsIndex"].prototype[name] = method
    for name,method of window[capitalize(this.controller())+"Controller"][this.view()]
      window[capitalize(this.controller())+"Index"].prototype[name]=method
